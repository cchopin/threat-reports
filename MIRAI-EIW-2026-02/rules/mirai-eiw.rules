# Mirai.EIW Variant - Suricata/Snort Rules
# Author: cchopin
# Date: 2026-02-06
# Reference: ../02_threat_intelligence.md

# Detection Mirai C2 communication on port 6969
alert tcp any any -> any 6969 (msg:"MALWARE Possible Mirai C2 (port 6969)"; flow:established,to_server; sid:1000001; rev:1;)

# Detection Mirai C2 beacon via HTTP
alert http any any -> any any (msg:"MALWARE Mirai C2 beacon - /info.json"; content:"GET"; http_method; content:"/info.json"; http_uri; sid:1000002; rev:1;)

# Detection Mirai C2 client registration
alert http any any -> any any (msg:"MALWARE Mirai C2 client registration"; content:"POST"; http_method; content:"/client"; http_uri; sid:1000003; rev:1;)

# Detection known C2 infrastructure
alert tcp any any -> 91.92.241.12 any (msg:"MALWARE Mirai.EIW C2 - Primary"; sid:1000004; rev:1;)
alert tcp any any -> 91.92.243.113 any (msg:"MALWARE Mirai.EIW C2 - Dropper distribution"; sid:1000005; rev:1;)
alert tcp any any -> 91.92.241.10 any (msg:"MALWARE Mirai.EIW C2 - Payload download"; sid:1000006; rev:1;)

# Detection .kok file download
alert http any any -> any any (msg:"MALWARE Mirai.EIW payload download (.kok)"; content:".kok"; http_uri; sid:1000007; rev:1;)
